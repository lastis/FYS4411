\documentclass[twocolumn,12pt]{extarticle}
\usepackage[english]{babel} 
\usepackage[latin1]{inputenc} 
\usepackage{times}			% Default times font style
\usepackage[T1]{fontenc} 	% Font encoding
\usepackage{amsmath} 		% Math package
\usepackage{mathtools} 		% Adds the declare paired 
							% delimeter command to make costom \abs and \norm
\usepackage{breqn}		 	% Adds dmath environment for automated brakeline
\usepackage{xfrac}			% Adds slanted fractions (sfrac)
\usepackage{cancel}			% Adds the cancel command, a slash through the symbol(s)
\usepackage{tabularx}		% Adds adjustable width on tabulars
\usepackage{cuted}			% Adds the strip command, pagewidth text in a twocolumn
							% environment. 
\usepackage{hyperref}
\usepackage[a4paper, margin=1in]{geometry}

% Start custom \abs \norm 
\DeclarePairedDelimiter\abs{\lvert}{\rvert}%
\DeclarePairedDelimiter\norm{\lVert}{\rVert}%
% Swap the definition of \abs* and \norm*, so that \abs
% and \norm resizes the size of the brackets, and the 
% starred version does not.
\makeatletter
\let\oldabs\abs
\def\abs{\@ifstar{\oldabs}{\oldabs*}}
%
\let\oldnorm\norm
\def\norm{\@ifstar{\oldnorm}{\oldnorm*}}
\makeatother
% End custom \abs \norm 

\usepackage{titlesec}
\titleformat{\section}[block]{\bfseries\filcenter}{\thesection}{1em}{\uppercase}
\titleformat{\subsection}[hang]{\bfseries\filcenter}{\thesubsection}{1em}{}
\titleformat{\subsubsection}[hang]{\bfseries\filcenter}{\thesubsubsection}{1em}{}

% TODO: Put comments on this section.
\newcommand{\eq}[1]{{\small\begin{align*}#1\end{align*}}}
\newcommand{\equ}[1]{{\small\begin{align}#1\end{align}}}
\newcommand{\mat}[1]{\begin{matrix}#1\end{matrix}}
\renewcommand\vec[1]{\mathbf{#1}}
\newcommand{\OP}[1]{\mathbf{\widehat{#1}}}
\newcommand{\op}[1]{\hat{#1}}
\newcommand{\unit}[1]{\mathbf{\hat{#1}}}
\renewcommand{\thesection}{\Roman{section}.}
\renewcommand{\thesubsection}{\Alph{subsection}.}

\title{}

\begin{document}

\twocolumn[{%
 \centering
 {\bfseries\large Variational Monte-Carlo Simulations of Atomic Systems}
 \\[1em]
 \normalsize Daniel Marelius Bj\o rnstad and Alexander Fleischer
 \\
 \small\url{https://github.com/lastis/FYS4411}
  \begin{abstract}
    This is where the abstract goes. Write something smrt here.
  \end{abstract}
 \\[3em] % some more space after the title part
}]



\section{Introduction}

To evaluate the results of the numerical methods, we investigated the possibility
of finding a closed-form solution of the ground-state energy 
using the Variational Principle.

\section{Methods}
\subsection{Trial Wavefunctions}

The trial wavefunction of Beryllium can be written as a product of a Slater determinant
part and a correlation part on the form
\equ{
  \psi_{T}(\vec r_1, \vec r_2, \vec r_3, \vec r_4) = \psi_{D}\psi_{C} \label{psiT}
}
where the Slater determinant is
\equ{
  \psi_D &= Det\left(\phi_{1}(\vec r_1),\phi_{2}(\vec r_2),
    \phi_{3}(\vec r_3),\phi_{4}(\vec r_4)\right) \label{psiD}\\
  &= \left(\phi_{1s}^1\phi_{2s}^2
    -\phi_{1s}^2\phi_{2s}^1\right)
    \left(\phi_{1s}^3\phi_{2s}^4
    -\phi_{1s}^4\phi_{2s}^3\right)\nonumber
}
and the correlation part is
\equ{
  \psi_C = \prod_{i<j}^{4} g_{ij}
   =\prod_{i<j}^{4}\exp{\left(\frac{ar_{ij}}{1+\beta r_{ij}}\right)} \label{psiC}
}
Here $\phi_i(\vec r_i)$ are the hydrogen-like wavefunctions. They are given by
the $1s$ and $2s$ orbital parts
\eq{                                                               
  \phi_{1s}^i &= e^{-\alpha r_i}\\
  \phi_{2s}^i &= \left(1-\alpha r_i/2\right)e^{-\alpha r_i/2}
}
which are dependent on the cartesian positions $\vec r_i = (x_i,y_i,z_i)$. 
The relative distance between two particles is
\eq{
  r_{ij} = \abs{\vec r_j - \vec r_i} = \sqrt{(x_j-x_i)^2+(y_j-y_i)^2+(z_j-z_i)^2}
}
and obviously $r_{ij}=r_{ji}$.

We want to determine the local energy $E_L$ to approximate
the ground state energy of the atom.
The general expression for the local energy is
\eq{
  E_L = \frac{1}{\psi_T (\vec R)}\OP H \psi_T (\vec R) 
}
and the Hamiltonian can generally be described as a sum of the contributions
to the potential energy by the electron-electron repulsion and the nucleus-electron interaction, as well as the kinetic energy. This gives us a Hamiltonian
for $N$ particles on the form
\eq{
  \OP H &= \OP K + \OP V \\
  &=\sum_i (\op k_i + \op v_i)  + \sum_{i<j} \op v_{ij}\\
  &= -\sum_{i=1}^N\bigg[
    \frac{\op\nabla_i^2}{2} + \frac{Z}{r_i}\bigg] 
  + \sum_{i=1}^{N-1}\sum_{j=i+1}^N\frac{1}{r_{ij}}
}
Where $Z$ is the atomic number.

From this expression, it's clear that $\OP K$ is the only operator that changes the
trial wavefunction when we calculate the local energy. Therefore, we must calculate the
following quantities
\eq{
  \frac{1}{\psi_T}\op k_i \psi_T = -\frac{1}{2}\frac{\op\nabla_i^2 \psi_T}{\psi_T}
}
For Beryllium, the trial wavefunction is a product of the Slater determinant part 
and the correlation part, namely $\psi_T = \psi_D\psi_C$.

The product rule of differentiation gives us
\eq{
  \frac{\op\nabla^2 \psi_T}{\psi_T} = 
  \frac{\op\nabla^2 \psi_D}{\psi_D}
    +2 \frac{\op\nabla \psi_D}{\psi_D}\cdot\frac{\op\nabla \psi_C}{\psi_C}
    +\frac{\op\nabla^2 \psi_C}{\psi_C}
}

\subsection{Efficient Computation of the Slater Determinant}

For larger atoms, the evaluation of the gradient and the Laplacian of the Slater
determinant becomes increasingly numerically demanding
to compute. Computing these quantities with brute force, 
leads to $N\cdot d$ operations to find the determinant and thus
multiplying this with our $O(N^3)$ operations.

ADD THE SLATER-DETERMINANT MATH HERE:

We can approximate the Slater determinant as
\eq{
	\Phi(\vec r_1, ..., \vec r_N) \propto \det\uparrow\cdot\det\downarrow
}
where the spin determinants are the determinants which only depend on spin up and spin down
respectively. The determinants are $2\times 2$ for Berylllium and $5\times 5$ for Neon.
This is true only if $\OP H$ is spin independent.

Then, $\det \op D = |\op D| = |\op D|_{\uparrow}\cdot |\op D|_{\downarrow}$, 
where the Slater matrices are dependent on the positions of the electrons. 
Each time we update the positions and differentiate the Slater determinant,
the Slater matrix is changed, but by calculating the determinant 
from scratch each time, we will certainly do unnecessary computations. 

This is solved by the following algorithm, that instead of calculating 
the determinant, updates the \textit{inverse} of the Slater matrix suitably.

We first express $i,j$-element of the inverse of $\op D$ as
\eq{
  d_{ij}^{-1} = \frac{C_{ji}}{|\op D|}
}
where $C_{ji}$ is the transposed cofactor-matrix element of $\op D$.

This motivates the ratio
\eq{
  R \equiv \frac{|\op D|_{\uparrow}^{new}}{|\op D|_{\uparrow}^{old}} 
  \cdot \frac{|\op D|_{\downarrow}^{new}}{|\op D|_{\downarrow}^{old}}
  = \frac{\sum_{j=1}^N d_{ij}^{new} C_{ij}^{new}}
    {\sum_{j=1}^N d_{ij}^{old} C_{ij}^{old}}
}
Every time we move particle $i$, the $i$-th row of $\op D$ changes,
and we have to update the inverse. However, the $i$-th row of $\op C$
is independent 


SAY SOMETHING ABOUT SCALING
\section{Results}

\appendix
\renewcommand{\thesubsection}{Appendix \Alph{subsection}:}
\renewcommand{\thesubsubsection}{\arabic{subsubsection}.}
\subsection{Mathematical Derivations}
\subsubsection{The wavefunction of Beryllium}
We start by finding the first and second derivative of the determinant part,
which are only dependent on the radii of the particles. This means that the gradient can be written 
\eq{
  \op\nabla f = \unit r \frac{\partial f}{\partial r}
  \;\text{ and }\;
  \op\nabla^2 f = \frac{\partial^2 f}{\partial r^2} 
    + \frac{2}{r}\frac{\partial f}{\partial r}
}
where $\vec r = r\unit r$.
  
We define the functions
\eq{
  f_i &\equiv -\frac{\alpha \vec r_i}{2}\\
  g_i &\equiv \exp(f_i)\\
  F_{ij} &\equiv \phi_{1s}(\vec r_i)\phi_{2s}(\vec r_j)
  -\phi_{1s}(\vec r_j)\phi_{2s}(\vec r_i)
}
and use them to simplify derivatives 
of the Hydrogen-like wavefunctions in the following way
\eq{
  \phi_{1s}^i &= g_i^2\\
  \frac{\partial \phi_{1s}^i}{\partial r_i} &= -\alpha g_i^2\\
  \frac{\partial^2 \phi_{1s}^i}{\partial r_i^2} &= \alpha^2 g_i^2\\
  \phi_{2s}^i &= g_i(1+f_i)\\
  \frac{\partial \phi_{2s}^i}{\partial r_i} &= -\alpha g_i(1+f_i/2)\\
  \frac{\partial^2 \phi_{2s}^i}{\partial r_i^2} &= \frac{3\alpha^2}{4} g_i(1+f_i/3)\\
  \phi_{2p_k}^i &= \alpha k_i g_i \text{ for } k_i = x_i,y_i,z_i\\
  \frac{\partial\phi_{2p_k}^i}{\partial r_i} 
    &= \left( \frac{1}{r_i} - \frac{\alpha}{2} \right) \alpha k_i g_i \\
  \frac{\partial^2\phi_{2p_k}^i}{\partial r_i^2} 
    &=\left(\left[ \frac{1}{r_i} - \frac{\alpha}{2} \right]^2 
    -\frac{1}{r_i}\right) \alpha k_i g_i
}
and then the terms required to calculate the Slater determinant
\eq{
  F_{ij} &= g_i^2 (1+f_j)g_j - g_j^2 (1+f_i)g_i\\
  \frac{\partial F_{ij}}{\partial r_i} 
    &= -\alpha g_i g_j (g_i(1+f_j) - g_j (1+f_i/2))\\
  \frac{\partial^2 F_{ij}}{\partial r_i^2} 
    &= \alpha^2 g_i g_j (g_i(1+f_j) - \frac{3}{4} g_j (1+f_i/3))\\
  \frac{\partial F_{ij}}{\partial r_j} 
    &= \alpha g_i g_j (g_j(1+f_i) - g_i (1+f_j/2))\\
  \frac{\partial^2 F_{ij}}{\partial r_j^2} 
    &= -\alpha^2 g_i g_j (g_j(1+f_i) - \frac{3}{4} g_i (1+f_j/3))\\
}
The determinant part is
\eq{
  \psi_D = F_{12}F_{34}
}
where the first is only affected by differentiation with respect to particle 1 or 2,
and opposite for the second part
\eq{
  \mat{
    \frac{\op\nabla_1 \psi_D}{\psi_D} = \frac{\op\nabla_1 F_{12}}{F_{12}} &
    \frac{\op\nabla_2 \psi_D}{\psi_D} = \frac{\op\nabla_2 F_{12}}{F_{12}} \\\\
    \frac{\op\nabla_3 \psi_D}{\psi_D} = \frac{\op\nabla_3 F_{34}}{F_{34}} &
    \frac{\op\nabla_4 \psi_D}{\psi_D} = \frac{\op\nabla_4 F_{34}}{F_{34}}
  }
}
The result is two different quantities
\eq{
  \frac{\op\nabla_k \psi_D}{\psi_D} =
  \begin{cases}
    \frac{\op\nabla_i F_{ij}}{F_{ij}}
    &= -\alpha \frac{\vec r_i}{r_i} \frac{(g_i(1+f_j) 
      - g_j (1+f_i/2))}{g_i (1+f_j) - g_j (1+f_i)}
    ,\text{ if } k=i=j-1 \\\\
    \frac{\op\nabla_j F_{ij}}{F_{ij}}
    &= -\alpha \frac{\vec r_j}{r_j}\frac{(g_i (1+f_j/2) 
      - g_j(1+f_i))}{g_i (1+f_j) - g_j (1+f_i)}
    ,\text{ if } k=j=i+1
  \end{cases}
}
one for particles 1 and 3, and one for 2 and 4, where $i\in {1,3}$ and $j\in {2,4}$.

For the second derivative part, we have 
\eq{
  \frac{\op\nabla_k^2 \psi_D}{\psi_D} =
  \begin{cases}
    \frac{\op\nabla_i^2 F_{ij}}{F_{ij}}
    &= \frac{\alpha^2 (g_i(1+f_j) 
      - \frac{3}{4} g_j (1+f_i/3)) - \frac{2\alpha}{r}(g_i(1+f_j) - g_j (1+f_i/2))}
      {g_i (1+f_j) - g_j (1+f_i)}\\\\
    \frac{\op\nabla_j^2 F_{ij}}{F_{ij}}
    &= \frac{\alpha^2 (\frac{3}{4}g_i(1+f_j/3) 
      - g_j (1+f_i)) - \frac{2\alpha}{r}(g_i (1+f_j/2) 
      - g_j(1+f_i))}
      {g_i (1+f_j) - g_j (1+f_i)}
  \end{cases}
}
with the same conditions as above.
Now we move on to the calculation of the correlation parts,
given by the function in (\ref{psiC}). 

First off, we define
\eq{
  f_{ij} \equiv \frac{ar_{ij}}{1+\beta r_{ij}}
}
with the corresponding derivatives (with respect to $r_{ij}$)
\eq{
  f_{ij}' &= \frac{a}{(1+\beta r_{ij})^2}\\
  f_{ij}'' &= \frac{-2a\beta}{(1+\beta r_{ij})^3}
}

The gradient of the wavefunction, 
divided by the wavefunction, for particle $k$ in the $x$-direction is then
\eq{
  \left[\frac{\op\nabla_k\psi_C}{\psi_C}\right]_x 
  =\frac{1}{\psi_C}\frac{\partial\psi_C}{\partial x_k}
}
If we look at the first derivative in the $x$-direction, 
we see that the parts of the wavefunction that is not dependent on $k$, 
will remain unaffected by the 
differentiation.
When we split the expression for $i<k$ and $k>i$, we get that
\equ{
  \frac{\partial\psi_C}{\partial x_k}&=\prod_{i,j\neq k} g_{ij}
    \frac{\partial}{\partial x_k}
    \left[ \prod_{i<k} g_{ik} \cdot \prod_{i>k} g_{ki} \right]\nonumber\\
    &=\prod_{i,j\neq k} g_{ij}
      \left[\prod_{i>k} g_{ki}\frac{\partial}{\partial x_k}\prod_{i<k} g_{ik} 
      + \prod_{i<k} g_{ik} \frac{\partial}{\partial x_k}\prod_{i>k} g_{ki} \right]
      \nonumber\\
    &=\prod_{i,j\neq k} g_{ij}
      \left[\prod_{i>k} g_{ki} \sum_{i<k} \frac{\partial g_{ik}}{\partial x_k} \prod_{p\neq i} g_{pi}
      + \prod_{i<k} g_{ik} \sum_{i>k} \frac{\partial g_{ki}}{\partial x_k} \prod_{q\neq i} g_{iq} \right]
      \nonumber\\
    &=\prod_{i<j} g_{ij}
      \left[\frac{1}{\prod_{i<k} g_{ik}} \sum_{i<k} 
      \frac{\partial g_{ik}}{\partial x_k} \prod_{p\neq i} g_{pi}
      + \frac{1}{\prod_{i>k} g_{ki}} \sum_{i>k} 
      \frac{\partial g_{ki}}{\partial x_k} \prod_{p\neq i} g_{pi} \right]
      \nonumber\\
    &=\psi_C
      \left[\sum_{i<k} \frac{1}{g_{ik}} \frac{\partial g_{ik}}{\partial x_k}
      +\sum_{i>k} \frac{1}{g_{ki}} \frac{\partial g_{ki}}{\partial x_k} \right]
      \label{DpsiC}
}
Here we factorized the wavefunction outside the expression, 
and noticed that the only part that doesn't cancel is the $ik$-th and $ki$-th
in the sums.

Dividing by the wavefunction, we get
\eq{
  \left[\frac{\op\nabla_k\psi_C}{\psi_C}\right]_x
  &=\sum_{i=1}^{k-1}\frac{1}{g_{ik}}\frac{\partial g_{ik}}{\partial x_k}  
  + \sum_{i=k+1}^{N}\frac{1}{g_{ki}}\frac{\partial g_{ki}}{\partial x_k} \\
  &=\sum_{i=1}^{k-1}\frac{\partial f_{ik}}{\partial x_k}  
  - \sum_{i=k+1}^{N}\frac{\partial f_{ki}}{\partial x_i}\\
  &=\sum_{i=1}^{k-1}\frac{x_k-x_i}{r_{ik}}\frac{\partial f_{ik}}{\partial r_{ik}}  
  - \sum_{i=k+1}^{N}\frac{x_i-x_k}{r_{ki}}\frac{\partial f_{ki}}{\partial r_{ki}}
}
since $g_{ij}$ is an exponential function, so
$\sfrac{\partial g_{ij}}{\partial x_i} = g_{ij} \sfrac{\partial f_{ij}}{\partial x_j}$.
We also used the fact that $\sfrac{\partial g_{ij}}{\partial x_i} = \sfrac{-\partial g_{ij}}{\partial x_j}$ to differentiate with respect to the second index in both of the sums.
Finally, we have used the chain rule to attain an expression that is dependent
on the distance between the two particles
\eq{
  \frac{\partial f_{ij}}{\partial x_j} 
  = \frac{\partial f_{ij}}{\partial r_{ij}} \frac{\partial r_{ij}}{\partial x_j} 
  = \frac{x_j - x_i}{r_{ij}} \frac{\partial f_{ij}}{\partial r_{ij}}
}
Thus
\eq{
  \frac{\op\nabla_k\psi_C}{\psi_C} &=
    \sum_{i=1}^{k-1}\frac{\vec r_{ik}}{r_{ik}}\frac{\partial f_{ik}}{\partial r_{ik}}  
    - \sum_{i=k+1}^{N}\frac{\vec r_{ki}}{r_{ki}}\frac{\partial f_{ki}}{\partial r_{ki}}\\
    &=\sum_{i=1}^{k-1}\frac{\vec r_{ik}}{r_{ik}}\frac{a}{(1+\beta r_{ik})^2}  
    - \sum_{i=k+1}^{N}\frac{\vec r_{ki}}{r_{ki}}\frac{a}{(1+\beta r_{ki})^2}\\
    &=\sum_{i\neq k}\frac{\vec r_{ik}}{r_{ik}}\frac{a}{(1+\beta r_{ik})^2} 
}

From (\ref{DpsiC}), we can gather that the double derivative part is described by
\eq{
  \left[\frac{\mathbf{\op\nabla}^2 \psi_C}{\psi_C}\right]_x
  &=\frac{1}{\psi_C}\frac{\partial}{\partial x_k}\left(\psi_C
      \left[\sum_{i<k} \frac{\partial f_{ik}}{\partial x_k}
      +\sum_{i>k} \frac{\partial f_{ki}}{\partial x_k} \right]\right)\\
  &=\left[\sum_{i<k} \frac{\partial^2 f_{ik}}{\partial x_k^2}
      +\sum_{i>k} \frac{\partial^2 f_{ki}}{\partial x_k^2} \right]
      +\frac{1}{\psi_C}\frac{\partial \psi_C}{\partial x_k}
      \left[\sum_{i<k} \frac{\partial f_{ik}}{\partial x_k}
      +\sum_{i>k} \frac{\partial f_{ki}}{\partial x_k} \right]\\
  &=\sum_{i\neq k}\frac{\partial^2 f_{ik}}{\partial x_k^2} +
    \left[\sum_{i=1}^{k-1}\frac{\partial f_{ik}}{\partial x_k} -
    \sum_{i=k+1}^{N}\frac{\partial f_{ki}}{\partial x_i}
    \right]^2\\
  &=\sum_{i\neq k}
    \frac{\partial}{\partial x_k}
    \left(
    \frac{\partial f_{ik}}{\partial r_{ik}}
    \frac{\partial r_{ik}}{\partial x_k}
    \right)+
    \left[\sum_{i\neq k}\frac{\partial r_{ik}}{\partial x_k}
    \frac{\partial f_{ik}}{\partial r_{ik}}
    \right]^2\\
  &=\sum_{i\neq k}
    \left[
    \frac{\partial r_{ik}}{\partial x_k}
    \frac{\partial}{\partial x_k}
    \frac{\partial f_{ik}}{\partial r_{ik}}
    +
    \frac{\partial f_{ik}}{\partial r_{ik}}
    \frac{\partial^2 r_{ik}}{\partial x_k^2}\right]
    +
    \left[\sum_{i\neq k}\frac{\partial r_{ik}}{\partial x_k} f_{ik}'
    \right]
    \left[\sum_{j\neq k}\frac{\partial r_{jk}}{\partial x_k} f_{jk}'
    \right]\\
  \left[\frac{\mathbf{\op\nabla}^2 \psi_C}{\psi_C}\right]_x
  &=\sum_{i\neq k}
    \left[
    \left(
    \frac{\partial r_{ik}}{\partial x_k}
    \right)^2
    f_{ik}''
    +
    f_{ik}'
    \frac{r_{ik}^2 - (x_k-x_i)^2}{r_{ik}^3}\right]
    \\&+
    \sum_{j\neq k}\left[\frac{\partial r_{ik}}{\partial x_k} f_{ik}'\left(
    \frac{\partial r_{ik}}{\partial x_k} f_{ik}'+
    \sum_{j\neq k,i} \frac{\partial r_{jk}}{\partial x_k} f_{jk}'\right)
    \right]\\
  \left[\frac{\mathbf{\op\nabla}^2 \psi_C}{\psi_C}\right]_x
  &=\sum_{i\neq k}
    \left[
    \left(
    \frac{\partial r_{ik}}{\partial x_k}
    \right)^2
    f_{ik}''
    +
    f_{ik}'
    \frac{r_{ik}^2 - (x_k-x_i)^2}{r_{ik}^3}\right]
    \\&+
    \sum_{j\neq k}\left[\left(\frac{\partial r_{ik}}{\partial x_k} f_{ik}'\right)^2
    +
    \sum_{j\neq k,i} \frac{\partial r_{ik}}{\partial x_k} f_{ik}'
    \frac{\partial r_{jk}}{\partial x_k} f_{jk}'
    \right]\\
  \left[\frac{\mathbf{\op\nabla}^2 \psi_C}{\psi_C}\right]_x
  &=\sum_{i\neq k}
    \left[
    \left(
    \frac{x_k-x_i}{r_{ik}}
    \right)^2
    f_{ik}''
    +
    f_{ik}'
    \frac{r_{ik}^2 - (x_k-x_i)^2}{r_{ik}^3}\right]
    \\&+
    \sum_{j\neq k}\left[\left(\frac{x_k-x_i}{r_{ik}} f_{ik}'\right)^2
    +
    \sum_{j\neq k,i} \frac{(x_k-x_i)(x_k-x_j)}{r_{ik} r_{jk}} 
    f_{ik}' f_{jk}'
    \right]\\
    \left[\frac{\mathbf{\op\nabla}^2 \psi_C}{\psi_C}\right]_x
  &=\sum_{i\neq k}
    \left[
    \left(
    \frac{x_k-x_i}{r_{ik}}
    \right)^2
    f_{ik}''
    +
    f_{ik}'
    \frac{r_{ik}^2 - (x_k-x_i)^2}{r_{ik}^3}\right]
    \\&+
    \sum_{i,j\neq k}\frac{(x_k-x_i)(x_k-x_j)}{r_{ik} r_{jk}} 
    f_{ik}' f_{jk}'\\
}
If we now sum up for all dimensions, we get 
\eq{
  \frac{\mathbf{\op\nabla}^2 \psi_C}{\psi_C}
  &=\sum_{i\neq k}
    \left[\frac{r_{ik}^2}{r_{ik}^2}
    f_{ik}''
    +
    f_{ik}'
    \frac{3r_{ik}^2 - r_{ik}^2}{r_{ik}^3}\right]
    +
    \sum_{i,j\neq k}\frac{(x_k-x_i)(x_k-x_j)}{r_{ik} r_{jk}} 
    f_{ik}' f_{jk}'\\
  &=\sum_{i\neq k}
    \left[f_{ik}''+ \frac{2}{r_{ik}}f_{ik}'\right]
    +
    \sum_{i,j\neq k}\frac{(x_k-x_i)(x_k-x_j)}{r_{ik} r_{jk}} 
    f_{ik}' f_{jk}'
}
\end{document}